{% extends 'TitulacionSisAcademicoBundle:Home:index.html.twig' %}


{% block contenido %}
    
     <link type="text/css" rel="stylesheet" href="{{ asset('css/styles/animate.css') }}">
    <link type="text/css" rel="stylesheet" href="{{ asset('css/styles/all.css') }}">
    <link type="text/css" rel="stylesheet" href="{{ asset('css/flavr/flavr.css') }}">
    
      <script type="text/javascript">
        $(function () {
               TableAdvanced.init();          
          });  
      </script>
     
 <script type="text/javascript">
     
        var modelessEnviarMensajes;
                    
          $(document).ready(function (){
                
            $("#Limpiar").click(function (){
                $("#Paralelo").val(0);
                $("#TipoMensaje").val(0);
                $("#Asunto").val("");
                $("#mensaje").val("");
            });
            
            $("#Enviar").click(function (){
          
                    var Tipo = $("#TipoMensaje").val();
                    var Asunto = $("#Asunto").val();
                    var Mensaje = $("#mensaje").val();

                    if(Tipo == 0){
                        var  msg_alert = alert_bootstrap( 'enviar', 'Atenci&oacute;n', "Seleccione Un tipo de mensaje", 'sm', 'alert');
                                $( "#content-enviar" ).append( msg_alert );
                                $('#modal-enviar').modal('show');
                                $("#TipoMensaje").focus();
                          return false;
                       
                    }
                    if(Asunto == ""){
                           var  msg_alert = alert_bootstrap( 'enviar', 'Atenci&oacute;n', "Escriba un Asunto", 'sm', 'alert');
                                $( "#content-enviar" ).append( msg_alert );
                                $('#modal-enviar').modal('show');
                                $("#Asunto").focus();
                          return false;
                    }
                    if(Mensaje == ""){
                            var  msg_alert = alert_bootstrap( 'enviar', 'Atenci&oacute;n', "Redacte su mensaje", 'sm', 'alert');
                                $( "#content-enviar" ).append( msg_alert );
                                $('#modal-enviar').modal('show');
                                $("#mensaje").focus();
                          return false;
                    }
                    
                     modelessEnviarMensajes = new $.flavr({
                        modal   : true,
                        content : '<i class="fa fa-refresh fa-spin"></i> &nbsp;<b>Enviando mensajes...</b>',
                        buttons     : {}
                     });
                   
               });
               
         });
    
    
    
            function mensaje(id){                
                $("#Texto").html(id);
                $("#Modal").click();
            }
     
</script>
 {#   <script src="{{ asset('js/EnviarMensajes.js') }}"></script>#}
    {#<script src="{{ asset('js/ValidacionesNotificaciones.js') }}"></script>#}
<script src="{{ asset('theme/plugins/jQuery/jQuery-2.1.4.min.js') }}"></script>
     
<section class="content">
<button type="button" id="Modal" class="btn btn-info btn-lg" style="display: none" data-toggle="modal" data-target="#myModal">Open Modal</button>
    <!-- Modal content-->
    <div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    
    <div class="modal-content" >
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Mensaje Enviado</h4>       
      </div>
      <div class="modal-body">
        <p id="Texto"></p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
      </div>
    </div>

  </div>
</div>
    
   <div class="page-content" style="height: 600px;">
   <div  class="col-xs-14">
     
       <form id="form-enviar" method="post" action="{{ path('notificaciones_index') }}">  
           
            <div class="col-md-5" id="content-enviar">
               <div class="box box-solid">
                   <div class="panel-heading">                 
		       <div class="box-header with-border">
                            <h5 class="box-title">Enviar Mensajes</h5>
                       </div>
                
                    <div class="modal-body">
                        <div class="form-group">
                        <div class="input-group">
                        <span class="input-group-addon">DE:</span>
                        <input name="Emisor" type="text" runat="server" value="{{app.session.get('nom_usuario')}}" id="Emisor" class="form-control" disabled/>
                        </div>
                        </div>
                        <div class="form-group">
                        <div class="input-group">
                     
                        <div class="pull-right hidden-xs">
          <!-- Notifications Menu -->
             
                         {% if app.session.get('perfil') != perfilDoc or app.session.get('perfil') != perfilEst %}
                          <input type="checkbox" name="Profesores" checked id="Profesores"/> Profesores
                           <br />
                           <input type="checkbox" name="Estudiantes"  id="Estudiantes" /> Estudiantes 
                           <br><br>
                         {%endif%} 
                        {# {% if app.session.get('descRol') == "DOCENTE" %}
                          <input type="checkbox" name="Universidad" checked id="Universidad"/> Universidad
                           <br />
                           <input type="checkbox" name="Estudiantes"  id="Estudiantes" /> Estudiantes
                        {%endif%} #}   
                         {% if app.session.get('descRol') == "DOCENTE" %}
                       <select id="Paralelo" name="Paralelo">
                           {% for Paralelo in data.Paralelos %} 
                        <option value="{{ Paralelo.id_paralelo }}">{{ Paralelo.nombre_paralelo }}</option>                        
                           {%endfor%}  
                      </select>
                         {%endif%} 
                          
                            <select id="TipoMensaje" name="TipoMensaje">
                               <option value="0">-</option>
                               <option value="1">Mensaje</option>
                               <option value="2">Notificacion</option>
                               <option value="3">Evento</option>
                           </select>                        
                         
                      
                          
        </div>
                        </div>
                        </div>
                          <div class="form-group">
                        <div class="input-group">
                        <span class="input-group-addon">Asunto:</span>
                        <input name="Asunto" type="text" runat="server" id="Asunto" placeholder="Escriba un asunto" class="form-control"/>
                        </div>
                        </div>
                      
                        <div class="form-group">
                        <textarea name="mensaje" id="mensaje" class="form-control" placeholder="Redacte su mensaje" style="height: 120px;"></textarea>
                        </div>
                       
                        </div>
                    <div class="modal-body">
                        
                        <button type="submit" class="btn btn-success" id="Enviar"> Enviar Mensajes </button>
                     <button type="button" id="Limpiar" class="btn btn btn-danger">Limpiar</button>
                      
                    </div>
              
       
         
            </div>  
                </div>  
                </div>  
                          
           
                 
            <div class="col-md-7">           
                                 <div class="box box-solid">
                            <div class="panel-heading">    
                                       
                                
				
                <h5 class="box-title">Log Mensajes Enviados</h5>
               
           
             <br/>
                               <div class="portlet-body form">
			         <div class="form-wizard">
                                    <div class="form-body">
				        <table class="table table-striped table-bordered table-hover" id="sample_1">
				        <thead style="background-color: #3C8DBC;color:#fff">
				        <tr>
					        <th style="text-align: center"> Tipo </th>					       
					        <th style="text-align: center"> Asunto   </th>
					        <th style="text-align: center"> Detalle </th>
					        <th style="text-align: center">Fecha </th>
                                               <th style="text-align: center">Ver</th>
				        </tr>
				        </thead>
				        <tbody>
                    {% for facultad in data.facultades %} 
                            <tr>
                                <td style="text-align: center">{{ facultad.tipo_notificaciones }}</td>                               
                                <td style="text-align: center">{{ facultad.asunto }}</td>
                                <td style="text-align: center">{{ facultad.mensaje }}</td>
                                <td style="text-align: center">{{ facultad.fecha_registro }}</td>
                                <td style="text-align: center">  <a id="{{facultad.mensaje}}" onclick="mensaje(id)" style="cursor: pointer"><i class="fa fa-envelope-o"></i></a></td>
                            </tr>
                     {%endfor%}                              
                                                              
                    </tbody>
                                        </table>
			        </div>
		            </div>
                             </div>           
                      </div>
                             </div>              
            </div>
                
            
           <form> 


   
    
               </div>
   </div>
                     
  </div>
{% endblock %}


