{% extends 'TitulacionSisAcademicoBundle:Home:index.html.twig'%}
{% block home %}
    <link type="text/css" rel="stylesheet" href="{{ asset('css/styles/animate.css') }}">
    <link type="text/css" rel="stylesheet" href="{{ asset('css/styles/all.css') }}">
    <link type="text/css" rel="stylesheet" href="{{ asset('css/flavr/flavr.css') }}">
<style>
  #trash{
    width:32px;
    height:50px;
    float:left;
    padding-bottom: 15px;
    position: relative;
    margin-top: 37px;
  }
</style>
<style>
#div1 {width:350px;height:70px;padding:10px;border:1px solid #aaaaaa;}
</style>

<script src="{{ asset('js/calendarioeventos.js') }}"></script>
<section class="content">
          <div class="row">
            <div class="col-md-3">
              <div class="box box-solid">
                <div class="box-header with-border">
                  <h4 class="box-title">Eventos Académicos</h4>
                </div>
                <div class="box-body">
                  <!-- the events -->
                  <div id="external-events">
                       {#{dump(data)}#}
                      {%for count ,event in data %}
                          {% set color = event.descripcion|split("|") %}
                           {#{dump(color)}#}
                          {% if color|length == 1%}
                                {% set colorevent = 'rgb(0, 166, 90)' %}
                          {% else %}
                                {% set colorevent = color[1] %}
                          {% endif %}
                            <div ondblclick="inactivar_evento(this)" id="{{color[0]}}" name="{{event.id_parametro}}"  class="external-event" style="background-color: {{colorevent}}">{{color[0]}}</div>
                      {% endfor %}

                      <!-- </div> -->
                    <!-- <div class="external-event bg-green">Lunch</div> event.css({"background-color": currColor, "border-color": currColor, "color": "#fff"}).addClass("external-event");
                    <div class="external-event bg-yellow">Go home</div>
                    <div class="external-event bg-aqua">Do homework</div>
                    <div class="external-event bg-light-blue">Work on UI design</div>
                    <div class="external-event bg-red">Sleep tight</div> -->
                    <p>
                      <!-- <div id="div1" ondrop="drop(event)" ondragover="allowDrop(event)"></div> -->
                      <b>Remover evento</b><img src="{{ asset('images/trashcan.png') }}" id="trash" alt="">
                    </p>
                    <div class="checkbox" style="display:none;">
                      <label for="drop-remove">
                        <input type="checkbox" id="drop-remove" checked="true">
                        Remover evento
                      </label>
                    </div>
                  </div>


                </div><!-- /.box-body -->
              </div><!-- /. box -->
              <div class="box box-solid">
                <div class="box-header with-border">
                  <h3 class="box-title">Create Event</h3>
                </div>
                <div class="box-body">
                  <div class="btn-group" style="width: 100%; margin-bottom: 10px;">
                    <!--<button type="button" id="color-chooser-btn" class="btn btn-info btn-block dropdown-toggle" data-toggle="dropdown">Color <span class="caret"></span></button>-->
                    <ul class="fc-color-picker" id="color-chooser">
                      <li><a class="text-aqua" href="#"><i class="fa fa-square"></i></a></li>
                      <li><a class="text-blue" href="#"><i class="fa fa-square"></i></a></li>
                      <li><a class="text-light-blue" href="#"><i class="fa fa-square"></i></a></li>
                      <li><a class="text-teal" href="#"><i class="fa fa-square"></i></a></li>
                      <li><a class="text-yellow" href="#"><i class="fa fa-square"></i></a></li>
                      <li><a class="text-orange" href="#"><i class="fa fa-square"></i></a></li>
                      <li><a class="text-green" href="#"><i class="fa fa-square"></i></a></li>
                      <li><a class="text-lime" href="#"><i class="fa fa-square"></i></a></li>
                      <li><a class="text-red" href="#"><i class="fa fa-square"></i></a></li>
                      <li><a class="text-purple" href="#"><i class="fa fa-square"></i></a></li>
                      <li><a class="text-fuchsia" href="#"><i class="fa fa-square"></i></a></li>
                      <li><a class="text-muted" href="#"><i class="fa fa-square"></i></a></li>
                      <li><a class="text-navy" href="#"><i class="fa fa-square"></i></a></li>
                    </ul>
                  </div><!-- /btn-group -->
                  <div class="input-group">
                    <input id="new-event" type="text" class="form-control" placeholder="Event Title">
                    <div class="input-group-btn">
                      <button id="add-new-event" type="button" class="btn btn-primary btn-flat">Add</button>
                    </div><!-- /btn-group -->
                  </div><!-- /input-group -->
                </div>
              </div>
            </div><!-- /.col -->
            <div class="col-md-9">
              <div class="box box-primary">
                <div class="box-body no-padding">
                  <!-- THE CALENDAR -->
                  <div id="calendar"></div>
                </div><!-- /.box-body -->
              </div><!-- /. box -->
            </div><!-- /.col -->
          </div><!-- /.row -->
        </section><!-- /.content -->

    <script src="{{ asset('js/flavr/flavr.js') }}"></script>
    <script src="{{ asset('js/flavr/flavr.min.js') }}"></script>
    <script type="text/javascript">
        function insertar_eventos(date,id_evento){
          // alert(date);
            // date = new Date(date);
            $.post('{{path('admin_academico_insertar_eventos')}}', {start: date, end: date, id_evento: id_evento}, function(data) {
              if(data == 1){
                mensaje_cisc( "notice", "EVENTO INSERTADO CON ÉXITO");
              }else{
                  mensaje_cisc( "error", "En estos momentos tenemos problemas con los servidores, lamentamos los inconvenientes");
              }
            });
        }

        function crear_evento(evento_color){
          $.post('{{path('admin_academico_crear_eventos')}}', {evento: evento_color}, function(data) {
            if(data == 1){
                mensaje_cisc( "notice", "EVENTO INSERTADO CON ÉXITO");
            }else{
                mensaje_cisc( "error", "En estos momentos tenemos problemas con los servidores, lamentamos los inconvenientes");
            }
          });
        }

        function inactivar_evento(evet){
                $(evet).attr("name");
                // alert($(evet).attr("id"));
                // $("#titulo").val($(evet).attr("id"));
            var html =                '   <div class="form-row">' +
                '       <input id="titulo" type="text" name="titulo" ' +
                '       placeholder="Título" />' +
                '   </div>' +
                '   <div class="form-row">' +
                '       <select id="estado" name="estado" >' +
                '       <option>Activo</option>' +
                '       <option>Inactivo</option>' +
                '       </select>' +
                '   </div>' +
                '   <div class="form-row">' +
                '   </div>';

                var select = $(this).parent().siblings('.demo-select');
                var entrance = select.find('.animate-entrance :selected').text();
                var closing = select.find('.animate-closing :selected').text();

                new $.flavr({
                    title       : 'Editar Evento',
                    content     : '',
                    dialog      : 'form',
                    form        : { content: html, method: 'post' },
                    onSubmit    : function( $container, $form ){
                        $.post('', {param1: 'value1'}, function(data, textStatus, xhr) {
                          /*optional stuff to do after success */
                        });
                         // $.ajax({
                         //    url: '',
                         //    data: 'type=changetitle&title='+title+'&eventid='+event.id,
                         //    type: 'POST',
                         //    dataType: 'json',
                         //    success: function(response){
                         //      if(response.status == 'success')
                         //              $('#calendar').fullCalendar('updateEvent',event);
                         //    },
                         //    error: function(e){
                         //      alert('Error processing your request: '+e.responseText);
                         //    }
                         //  });
                        return false;
                    }
                });
$("#titulo").val($(evet).attr("id"));
        }
    </script>
    
{% endblock %}